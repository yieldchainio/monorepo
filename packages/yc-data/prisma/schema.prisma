generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["Yieldchain", "YieldchainV2"]
}

model functionsv2 {
  id                     String      @id @default(uuid())
  name                   String
  inverse_function_id    String?
  dependancy_function_id String?
  address_id             String
  arguments_ids          String[]
  callback               Boolean     @default(false)
  actions_ids            String[]
  inflows                String[]
  outflows               String[]
  ret_typeflag           Typeflags   @default(VALUE_VAR_FLAG)
  typeflag               Typeflags   @default(CALL_COMMAND_FLAG)
  signature              String
  copy_args              Boolean     @default(false)
  address                addressesv2 @relation(fields: [address_id], references: [id])
  actions                actionsv2[] @relation("actionsv2Tofunctionsv2")

  @@map("functions")
  @@schema("YieldchainV2")
}

model tokensv2 {
  id           String         @id @default(uuid())
  name         String
  address      String
  symbol       String
  logo         String         @default("https://etherscan.io/images/main/empty-token.png")
  decimals     Int
  chain_id     Int
  markets_ids  String[]
  argumentsv2  argumentsv2[]
  strategiesv2 strategiesv2[]

  @@map("tokens")
  @@schema("YieldchainV2")
}

model actionsv2 {
  id            String        @id @default(uuid())
  name          String
  popularity    Int
  available     Boolean
  table_name    String?
  functions_ids String[]
  function      functionsv2[] @relation("actionsv2Tofunctionsv2")
  protocols     protocolsv2[] @relation("actionsv2Toprotocolsv2")

  @@map("actions")
  @@schema("YieldchainV2")
}

model addressesv2 {
  id                String        @id @default(uuid())
  address           String
  abi               Json          @db.Json
  chain_id          Int
  protocol_id       String
  functions_ids     String[]      @default([])
  related_contracts String[]      @default([])
  network           networksv2    @relation(fields: [chain_id], references: [id])
  protocol          protocolsv2   @relation(fields: [protocol_id], references: [id])
  functions         functionsv2[]

  @@map("addresses")
  @@schema("YieldchainV2")
}

model networksv2 {
  id              Int            @id
  name            String
  logo            String
  json_rpc        String
  diamond_address String?
  block_explorer  String?
  color           String?
  addresses       addressesv2[]
  strategies      strategiesv2[]
  protocols       protocolsv2[]  @relation("networksv2Toprotocolsv2")

  @@map("networks")
  @@schema("YieldchainV2")
}

model argumentsv2 {
  id                       String    @id @default(uuid())
  value                    String
  custom                   Boolean   @default(false)
  solidity_type            String
  name                     String?
  dev_notes                String?
  typeflag                 Typeflags @default(VALUE_VAR_FLAG)
  ret_typeflag             Typeflags @default(VALUE_VAR_FLAG)
  relating_token           String?
  overridden_custom_values String[]  @default([])
  token                    tokensv2? @relation(fields: [relating_token], references: [id])

  @@map("arguments")
  @@schema("YieldchainV2")
}

model protocolsv2 {
  id          String         @id @default(uuid())
  name        String
  address_ids String[]
  logo        String
  available   Boolean        @default(false)
  website     String
  twitter     String?
  telegram    String?
  discord     String?
  color       String?
  chain_ids   Int[]
  verified    Boolean
  types       ProtocolType[] @default([INTEGRATION])
  addresses   addressesv2[]
  actions     actionsv2[]    @relation("actionsv2Toprotocolsv2")
  networks    networksv2[]   @relation("networksv2Toprotocolsv2")
  strategies  strategiesv2[] @relation("protocolsv2Tostrategiesv2")

  @@map("protocols")
  @@schema("YieldchainV2")
}

model strategiesv2 {
  id                 String        @id @default(uuid())
  address            String
  title              String
  creator_id         String
  chain_id           Int
  verified           Boolean       @default(false)
  execution_interval Int
  deposit_token_id   String
  seed_steps         Json          @default("{}") @db.Json
  tree_steps         Json          @default("{}") @db.Json
  uproot_steps       Json          @default("{}") @db.Json
  statistics         statistics[]
  network            networksv2    @relation(fields: [chain_id], references: [id])
  creator            usersv2       @relation(fields: [creator_id], references: [id])
  token              tokensv2      @relation(fields: [deposit_token_id], references: [id])
  protocols          protocolsv2[] @relation("protocolsv2Tostrategiesv2")

  @@map("strategies")
  @@schema("YieldchainV2")
}

model usersv2 {
  id                   String         @id @default(uuid())
  address              String
  username             String         @default("Anon")
  description          String         @default("I may have nothing to say, but that does not mean anything about me - withhold the judgement -*_*-")
  profile_picture      String?
  twitter              String?        @unique
  telegram             String?        @unique
  discord              String?        @unique
  whitelisted          Boolean        @default(false)
  verified             Boolean        @default(false)
  created_strategiesv2 strategiesv2[]

  @@map("users")
  @@schema("YieldchainV2")
}

model statistics {
  id          String       @id
  strategy_id String
  timestamp   DateTime     @default(now())
  apy         Int
  gasFee      String
  strategy    strategiesv2 @relation(fields: [strategy_id], references: [id])

  @@schema("YieldchainV2")
}

model actions {
  action_identifier Int      @id @default(autoincrement())
  name              String?
  single_function   Boolean? @map("single-function")
  popularity        String?
  hidden            Boolean?
  steps             steps[]

  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model addliquidity {
  function_identifier Int

  @@ignore
  @@schema("Yieldchain")
}

model address_relations {
  address_identifier                                          Int        @id
  address_identifier_2                                        Int?
  addresses_address_relations_address_identifier_2Toaddresses addresses? @relation("address_relations_address_identifier_2Toaddresses", fields: [address_identifier_2], references: [address_identifier], onDelete: NoAction, onUpdate: NoAction)
  addresses_address_relations_address_identifierToaddresses   addresses  @relation("address_relations_address_identifierToaddresses", fields: [address_identifier], references: [address_identifier], onDelete: NoAction, onUpdate: NoAction)

  @@schema("Yieldchain")
}

model addresses {
  address_identifier                                                  Int                 @id(map: "pools_pkey") @default(autoincrement())
  contract_address                                                    String?
  abi                                                                 Json?               @db.Json
  chain_id                                                            Int?
  functions                                                           Int[]
  address_relations_address_relations_address_identifier_2Toaddresses address_relations[] @relation("address_relations_address_identifier_2Toaddresses")
  address_relations_address_relations_address_identifierToaddresses   address_relations?  @relation("address_relations_address_identifierToaddresses")
  networks                                                            networks?           @relation(fields: [chain_id], references: [chain_id], onDelete: NoAction, onUpdate: NoAction, map: "pools_chain_id_fkey")

  @@schema("Yieldchain")
}

model base_types {
  type String @id

  @@schema("Yieldchain")
}

model flows {
  flow_identifier     Int     @id @default(autoincrement())
  token_identifier    Int?
  outflow0_or_inflow1 Int?
  tokens              tokens? @relation(fields: [token_identifier], references: [token_identifier], onDelete: NoAction, onUpdate: NoAction)

  @@schema("Yieldchain")
}

model forks {
  fork_id String @id

  @@schema("Yieldchain")
}

model functions {
  function_identifier                                              Int         @id @default(autoincrement())
  function_name                                                    String?
  number_of_parameters                                             Int?
  flows                                                            Int[]
  arguments                                                        Int[]
  is_callback                                                      Boolean?    @default(false)
  counter_function_identifier                                      Int?
  unlocked_by                                                      Int?
  call_type                                                        String?
  return_type                                                      String?
  return_base_type                                                 String?
  functions_functions_counter_function_identifierTofunctions       functions?  @relation("functions_counter_function_identifierTofunctions", fields: [counter_function_identifier], references: [function_identifier], onDelete: NoAction, onUpdate: NoAction)
  other_functions_functions_counter_function_identifierTofunctions functions[] @relation("functions_counter_function_identifierTofunctions")
  functions_functions_unlocked_byTofunctions                       functions?  @relation("functions_unlocked_byTofunctions", fields: [unlocked_by], references: [function_identifier], onDelete: NoAction, onUpdate: NoAction)
  other_functions_functions_unlocked_byTofunctions                 functions[] @relation("functions_unlocked_byTofunctions")

  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model harvest {
  function_identifier Int?

  @@ignore
  @@schema("Yieldchain")
}

model networks {
  chain_id        Int          @id
  name            String?
  logo            String?
  json_rpc        String?
  diamond_address String?
  block_explorer  String?
  color           String
  addresses       addresses[]
  strategies      strategies[]

  @@schema("Yieldchain")
}

model parameters {
  parameter_identifier Int     @id @default(autoincrement())
  index                Int?
  solidity_type        String?
  value                String?
  name                 String?

  @@schema("Yieldchain")
}

model protocols {
  protocol_identifier Int          @id @default(autoincrement())
  name                String?
  website             String?
  logo                String?
  is_verified         Boolean?
  avg_apy             Int?
  aggregated_tvl      Int?
  yc_vaults_num       Int?
  color               String?
  hidden              Boolean?     @default(false)
  strategies          strategies[]

  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model protocols_addresses {
  protocol_identifier Int?
  address_identifier  Int?

  @@ignore
  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model protocols_networks {
  protocol_identifier Int?
  chain_id            Int?

  @@ignore
  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model removeliquidity {
  function_identifier Int?

  @@ignore
  @@schema("Yieldchain")
}

model requestwithdrawal {
  function_identifier Int @id

  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model stake {
  function_identifier Int

  @@ignore
  @@schema("Yieldchain")
}

model steps {
  step_identifier     Int      @id @default(autoincrement())
  action_identifier   Int?
  function_identifier Int?
  multiplier          Int?
  actions             actions? @relation(fields: [action_identifier], references: [action_identifier], onDelete: NoAction, onUpdate: NoAction)

  @@schema("Yieldchain")
}

model strategies {
  strategy_identifier                              Int        @id @default(autoincrement())
  address                                          String?
  name                                             String?
  upkeep_id                                        Int?
  apy                                              Int?
  tvl                                              Int?
  main_protocol_identifier                         Int?
  creator_user_identifier                          Int?
  chain_id                                         Int?
  main_token_identifier                            Int?
  final_token_identifier                           Int?
  is_verified                                      Boolean?
  is_trending                                      Boolean?
  execution_interval                               Int?
  strategy_object                                  Json?
  networks                                         networks?  @relation(fields: [chain_id], references: [chain_id], onDelete: NoAction, onUpdate: NoAction)
  tokens_strategies_final_token_identifierTotokens tokens?    @relation("strategies_final_token_identifierTotokens", fields: [final_token_identifier], references: [token_identifier], onDelete: NoAction, onUpdate: NoAction)
  protocols                                        protocols? @relation(fields: [main_protocol_identifier], references: [protocol_identifier], onDelete: NoAction, onUpdate: NoAction)
  tokens_strategies_main_token_identifierTotokens  tokens?    @relation("strategies_main_token_identifierTotokens", fields: [main_token_identifier], references: [token_identifier], onDelete: NoAction, onUpdate: NoAction)

  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model swap {
  function_identifier Int?

  @@ignore
  @@schema("Yieldchain")
}

model tokens {
  token_identifier                                     Int          @id(map: "tokenss_pkey") @default(autoincrement())
  name                                                 String?
  address                                              String?
  symbol                                               String?
  logo                                                 String?
  decimals                                             Int?
  coinkey                                              String?
  priceusd                                             Float?
  chain_id                                             String?
  markets                                              Int[]
  flows                                                flows[]
  strategies_strategies_final_token_identifierTotokens strategies[] @relation("strategies_final_token_identifierTotokens")
  strategies_strategies_main_token_identifierTotokens  strategies[] @relation("strategies_main_token_identifierTotokens")

  @@schema("Yieldchain")
}

model users {
  user_identifier     Int     @id @default(autoincrement())
  address             String?
  username            String?
  profile_picture     String?
  description         String?
  twitter             String?
  discord             String?
  deployed_vaults_num Int?

  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model waitlist {
  address     String?
  email       String?
  twitter     String?
  telegram    String?
  discord     String?
  whitelisted Boolean? @default(false)

  @@ignore
  @@schema("Yieldchain")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by the Prisma Client.
model withdraw {
  function_identifier Int?

  @@ignore
  @@schema("Yieldchain")
}

enum ProtocolType {
  EXCHANGE
  INTEGRATION
  LIQUIDITY
  LENDING
  STAKING
  PERPS
  UNIV2LP
  @@schema("YieldchainV2")
}

enum FlowDirection {
  OUTFLOW
  INFLOW

  @@schema("YieldchainV2")
}

enum CallType {
  CALL
  DELEGATECALL
  STATICCALL

  @@schema("YieldchainV2")
}

enum VariableTypes {
  STATIC
  DYNAMIC

  @@schema("YieldchainV2")
}

enum Typeflags {
  VALUE_VAR_FLAG
  REF_VAR_FLAG
  COMMANDS_LIST_FLAG
  COMMANDS_REF_ARR_FLAG
  RAW_REF_VAR_FLAG
  STATICCALL_COMMAND_FLAG
  CALL_COMMAND_FLAG
  DELEGATECALL_COMMAND_FLAG
  INTERNAL_LOAD_FLAG

  @@schema("YieldchainV2")
}
